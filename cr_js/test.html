<html>
<head>
<link rel="stylesheet" href="scripts/lib/jquery-ui/jquery-ui.min.css">
<script data-main="scripts/vispy" src="scripts/lib/require.js"></script>
<script>
require.config({
  paths: {
    "jquery-ui": "lib/jquery-ui/jquery-ui.min",
    "screenfull": "lib/screenfull.min",
  }
});

require(["vispy", "jquery-ui", "screenfull"], function(vispy) {
    c = vispy.init("#mycanvas");

    var VS = " \
    attribute vec2 a_position; \
    void main() { \
        gl_Position = vec4(a_position, 0, 1); \
    }";

    var FS = " \
    void main() { \
        gl_FragColor = vec4(1, 1, 1, 1); \
    }";

    c.on_initialize(function (event) {
        vispy.gloo.glir.call(c, ['CREATE', 'myvbo', 'VertexBuffer']);
        vispy.gloo.glir.call(c, ['DATA', 'myvbo', 0, [-0.5, -0.5, 0.5, -0.5, 0.5, 0.5]]);

        vispy.gloo.glir.call(c, ['CREATE', 'myprogram', 'Program']);
        vispy.gloo.glir.call(c, ['SHADERS', 'myprogram', VS, FS]);
        vispy.gloo.glir.call(c, ['ATTRIBUTE', 'myprogram', 'a_position',
                                 'vec2', 'myvbo', 0, 0]);
    });

    c.on_resize(function(event) {
        vispy.gloo.glir.call(c, ['FUNC', 'viewport', 0, 0, event.size[0], event.size[1]]);
        this.update();
    });

    c.on_paint(function(event) {
        vispy.gloo.glir.call(c, ['FUNC', 'clearColor', 0, 0, 0, 1]);
        vispy.gloo.glir.call(c, ['FUNC', 'clear', 'COLOR_BUFFER_BIT']);
        vispy.gloo.glir.call(c, ['DRAW', 'myprogram', 'TRIANGLE_STRIP',
                                 [0, 3]]);
    });

    c.initialize();
    c.resize();

    window.onresize = function(event) {
        c.resize();
    };

    $(window).keypress(function(e) {
        var char = String.fromCharCode(e.which);
        if (char == 'f') {
            if (screenfull.enabled) {
                if(screenfull.isFullscreen) {
                    screenfull.exit();
                    c.resize(c._size);
                }
                else {
                    c._size = [c.$el.width(), c.$el.height()];
                    screenfull.request(c.$el[0]);
                    c.resize([screen.width, screen.height]);
                }
                
                
            }
        }
    });

});
</script>
<style>
body, #mycanvas {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
}
</style>
</head> 
<body>
<canvas id="mycanvas"></canvas>
</body>
</html>
